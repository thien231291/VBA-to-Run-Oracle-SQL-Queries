Option Explicit
Sub LDF()
    Dim strConn As String
    Dim conn As ADODB.Connection
    Dim rs As ADODB.Recordset
    Dim SQL As String
    Dim ssheet As Worksheet
    Dim i As Integer, j As Integer
    
    Application.ScreenUpdating = False
    
    Set conn = New ADODB.Connection
    Set rs = New ADODB.Recordset

    ' Connection String
    strConn = "Provider=OraOLEDB.oracle;Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=CompanyHostAddress)(PORT=PortNumber)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=ServiceName)));User Id=UserName;Password=Password;"
    conn.ConnectionString = strConn
    conn.Open

    ' SQL DELETE Statement
    SQL = "DELETE FROM TableName WHERE ASOF=" & Range("ASOF").Value & " AND LABEL='" & Range("LABEL").Value & "' AND POLICY_TYPE='" & Range("Policy_Type").Value & "' AND LOB='" & Range("LOB").Value & "' AND COMPANY='" & Range("Company").Value & "' AND DY='" & Range("DY").Value & "' AND CAP='" & Range("Cap").Value & "'"
    rs.Open SQL, conn, adOpenKeyset, adLockReadOnly

    ' List of Sheets Names
    Dim snames(1 To 19) As String
    snames(1) = "CDF_RC"
    ' Add the rest of the sheet names here

    For j = 2 To 53
        Set ssheet = Worksheets(snames(1))
        
        SQL = "INSERT ALL" & Chr(10)
        
        For i = 2 To 81
            SQL = SQL & " INTO T_LDF (ASOF, LABEL, DY, POLICY_TYPE, LOB, COMPANY, CAP, ST, AGE, " & Join(snames, ", ") & ") VALUES (" & Range("ASOF").Value & ",'" & Range("LABEL").Value & "','" & Range("DY").Value & "','" & Range("Policy_Type").Value & "','" & Range("LOB").Value & "','" & Range("Company").Value & "','" & Range("Cap").Value & "','" & ssheet.Cells(1, j).Value & "'," & ssheet.Cells(i, 1).Value & ","
            
            For Each sname In snames
                SQL = SQL & Worksheets(sname).Cells(i, j).Value & ","
            Next sname
            
            SQL = Left(SQL, Len(SQL) - 1) & ")" & Chr(10)
        Next i
        
        SQL = SQL & "SELECT 1 FROM DUAL"
        rs.Open SQL, conn, adOpenKeyset, adLockReadOnly
    Next j

    conn.Close
    Set conn = Nothing
    Set rs = Nothing

    Application.ScreenUpdating = True
    Inputs.Cells(27, 2).Value = Date & " " & Time
End Sub
